const data = {"Assault Rifle Single Shot":{"Armor 0":{"1: cqc 0-6m":15.8858,"2: close 7-12m":17.7342,"3: medium 13-25m":17.6935,"4: ideal 26-50m":17.7369,"5: far 51-100m":17.619,"6: extreme 101-200m":10.6054,"7: extreme ++ 201-400m":1.8643,"8: extreme +++ 400-800m":0.188},"Armor 4":{"1: cqc 0-6m":12.349,"2: close 7-12m":13.7436,"3: medium 13-25m":13.6865,"4: ideal 26-50m":13.6681,"5: far 51-100m":13.6914,"6: extreme 101-200m":8.2475,"7: extreme ++ 201-400m":1.4075,"8: extreme +++ 400-800m":0.0361},"Armor 7":{"1: cqc 0-6m":9.5438,"2: close 7-12m":10.6286,"3: medium 13-25m":10.6601,"4: ideal 26-50m":10.6361,"5: far 51-100m":10.6418,"6: extreme 101-200m":6.4574,"7: extreme ++ 201-400m":1.066,"8: extreme +++ 400-800m":0},"Armor 11":{"1: cqc 0-6m":6.0516,"2: close 7-12m":6.7171,"3: medium 13-25m":6.7346,"4: ideal 26-50m":6.7426,"5: far 51-100m":6.7561,"6: extreme 101-200m":4.0878,"7: extreme ++ 201-400m":0.7139,"8: extreme +++ 400-800m":0},"Armor 12":{"1: cqc 0-6m":5.1632,"2: close 7-12m":5.814,"3: medium 13-25m":5.7734,"4: ideal 26-50m":5.7396,"5: far 51-100m":5.8043,"6: extreme 101-200m":3.4857,"7: extreme ++ 201-400m":0.5858,"8: extreme +++ 400-800m":0},"Armor 13":{"1: cqc 0-6m":4.3912,"2: close 7-12m":4.9657,"3: medium 13-25m":4.8698,"4: ideal 26-50m":4.8909,"5: far 51-100m":4.887,"6: extreme 101-200m":2.9812,"7: extreme ++ 201-400m":0.4955,"8: extreme +++ 400-800m":0},"Armor 15":{"1: cqc 0-6m":2.9135,"2: close 7-12m":3.3054,"3: medium 13-25m":3.2985,"4: ideal 26-50m":3.2617,"5: far 51-100m":3.3396,"6: extreme 101-200m":1.9778,"7: extreme ++ 201-400m":0.329,"8: extreme +++ 400-800m":0},"Armor 18":{"1: cqc 0-6m":1.271,"2: close 7-12m":1.4426,"3: medium 13-25m":1.4464,"4: ideal 26-50m":1.4964,"5: far 51-100m":1.487,"6: extreme 101-200m":0.8924,"7: extreme ++ 201-400m":0.1513,"8: extreme +++ 400-800m":0}},"Assault Rifle Autofire":{"Armor 0":{"1: cqc 0-6m":9.1369,"2: close 7-12m":14.6796,"3: medium 13-25m":23.2231,"4: ideal 26-50m":14.7586,"5: far 51-100m":1.4568,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 4":{"1: cqc 0-6m":7.4477,"2: close 7-12m":12.2341,"3: medium 13-25m":19.4746,"4: ideal 26-50m":12.2507,"5: far 51-100m":1.0058,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 7":{"1: cqc 0-6m":6.2828,"2: close 7-12m":10.5129,"3: medium 13-25m":16.8308,"4: ideal 26-50m":10.5201,"5: far 51-100m":0.7135,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 11":{"1: cqc 0-6m":4.7251,"2: close 7-12m":8.2894,"3: medium 13-25m":13.3676,"4: ideal 26-50m":8.2634,"5: far 51-100m":0.3861,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 12":{"1: cqc 0-6m":4.4778,"2: close 7-12m":7.6189,"3: medium 13-25m":12.6458,"4: ideal 26-50m":7.6731,"5: far 51-100m":0.3234,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 13":{"1: cqc 0-6m":4.0197,"2: close 7-12m":7.0128,"3: medium 13-25m":11.7563,"4: ideal 26-50m":7.0375,"5: far 51-100m":0.2368,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 15":{"1: cqc 0-6m":3.6377,"2: close 7-12m":6.3065,"3: medium 13-25m":10.0238,"4: ideal 26-50m":6.2438,"5: far 51-100m":0.1701,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 18":{"1: cqc 0-6m":2.5998,"2: close 7-12m":4.7295,"3: medium 13-25m":7.9973,"4: ideal 26-50m":4.8687,"5: far 51-100m":0.0556,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0}},"Assault Rifle Targeted Head Shot":{"Armor 0":{"1: cqc 0-6m":10.6966,"2: close 7-12m":14.2763,"3: medium 13-25m":17.7982,"4: ideal 26-50m":24.6647,"5: far 51-100m":17.7187,"6: extreme 101-200m":0.1875,"7: extreme ++ 201-400m":0.172,"8: extreme +++ 400-800m":0.154},"Armor 4":{"1: cqc 0-6m":8.1266,"2: close 7-12m":10.9312,"3: medium 13-25m":13.8164,"4: ideal 26-50m":19.1082,"5: far 51-100m":13.7864,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 7":{"1: cqc 0-6m":6.3899,"2: close 7-12m":8.5503,"3: medium 13-25m":10.7999,"4: ideal 26-50m":14.7885,"5: far 51-100m":10.7754,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 11":{"1: cqc 0-6m":3.9218,"2: close 7-12m":5.2661,"3: medium 13-25m":6.593,"4: ideal 26-50m":9.2251,"5: far 51-100m":6.5885,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 12":{"1: cqc 0-6m":3.4005,"2: close 7-12m":4.5556,"3: medium 13-25m":5.6245,"4: ideal 26-50m":7.9656,"5: far 51-100m":5.7238,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 13":{"1: cqc 0-6m":2.9452,"2: close 7-12m":3.9394,"3: medium 13-25m":4.9364,"4: ideal 26-50m":6.7491,"5: far 51-100m":4.8816,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 15":{"1: cqc 0-6m":1.9253,"2: close 7-12m":2.5708,"3: medium 13-25m":3.2033,"4: ideal 26-50m":4.4711,"5: far 51-100m":3.2157,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 18":{"1: cqc 0-6m":0.8194,"2: close 7-12m":1.1265,"3: medium 13-25m":1.4182,"4: ideal 26-50m":1.9996,"5: far 51-100m":1.4401,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0}},"Assault Rifle Targeted Leg Shot":{"Armor 0":{"1: cqc 0-6m":7.3332,"2: close 7-12m":9.6121,"3: medium 13-25m":11.7831,"4: ideal 26-50m":16.0588,"5: far 51-100m":11.7079,"6: extreme 101-200m":0.364,"7: extreme ++ 201-400m":0.342,"8: extreme +++ 400-800m":0.352},"Armor 4":{"1: cqc 0-6m":5.7769,"2: close 7-12m":7.5208,"3: medium 13-25m":9.4124,"4: ideal 26-50m":13.1178,"5: far 51-100m":9.4416,"6: extreme 101-200m":0.225,"7: extreme ++ 201-400m":0.2106,"8: extreme +++ 400-800m":0.2034},"Armor 7":{"1: cqc 0-6m":4.5554,"2: close 7-12m":6.1263,"3: medium 13-25m":7.6616,"4: ideal 26-50m":10.8916,"5: far 51-100m":7.7028,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 11":{"1: cqc 0-6m":3.4812,"2: close 7-12m":4.5317,"3: medium 13-25m":5.6267,"4: ideal 26-50m":7.8873,"5: far 51-100m":5.6518,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 12":{"1: cqc 0-6m":3.1664,"2: close 7-12m":4.1689,"3: medium 13-25m":5.292,"4: ideal 26-50m":7.2082,"5: far 51-100m":5.2824,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 13":{"1: cqc 0-6m":2.8333,"2: close 7-12m":3.706,"3: medium 13-25m":4.599,"4: ideal 26-50m":6.5118,"5: far 51-100m":4.623,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 15":{"1: cqc 0-6m":2.0233,"2: close 7-12m":2.7294,"3: medium 13-25m":3.3825,"4: ideal 26-50m":4.7571,"5: far 51-100m":3.4152,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0},"Armor 18":{"1: cqc 0-6m":1.0418,"2: close 7-12m":1.3112,"3: medium 13-25m":1.7438,"4: ideal 26-50m":2.447,"5: far 51-100m":1.7346,"6: extreme 101-200m":0,"7: extreme ++ 201-400m":0,"8: extreme +++ 400-800m":0}}}

function generateHeatMapTable(tableId, chartTitle, chartData) {
    const table = document.getElementById(tableId);
    table.innerHTML = '';
    const armorLevels = Object.keys(chartData[chartTitle]);
    const rangeLabels = Object.keys(chartData[chartTitle]["Armor 0"]);

    // Create table header
    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    headerRow.insertCell().textContent = "Range / Armor";
    for (const armorLevel of armorLevels) {
        const th = document.createElement('th');
        th.textContent = armorLevel.replace("Armor ", "");
        headerRow.appendChild(th);

    }
    const tbody = table.createTBody();
    // Create table rows
    for (const rangeLabel of rangeLabels) {
        const row = tbody.insertRow();
        const rangeCell = row.insertCell();
        rangeCell.textContent = rangeLabel.replace(/\d+:\s/, "");
        for (const armorLevel of armorLevels) {
            const damage = chartData[chartTitle][armorLevel][rangeLabel];
            const heatCell = row.insertCell();
            heatCell.classList.add("heat-cell")

            const color = getColorForValue(damage);
            heatCell.innerHTML = `<div class="heat-cell-color" style="background-color: ${color}">${damage.toFixed(1)}</div>`
        }
    }
}
function generateBestTypeTable(tableId, chartData) {
    const table = document.getElementById(tableId);
    table.innerHTML = '';
    const attackTypes = Object.keys(chartData);
    const armorLevels = Object.keys(chartData[attackTypes[0]]);
    const rangeLabels = Object.keys(chartData[attackTypes[0]]["Armor 0"]);

    // Create table header
    const thead = table.createTHead();
    const headerRow = thead.insertRow();
    headerRow.insertCell().textContent = "Range / Armor";
    for (const armorLevel of armorLevels) {
        const th = document.createElement('th');
        th.textContent = armorLevel.replace("Armor ", "");
        headerRow.appendChild(th);
    }

    const tbody = table.createTBody();
    for (const rangeLabel of rangeLabels) {
        const row = tbody.insertRow();
        const rangeCell = row.insertCell();
        rangeCell.textContent = rangeLabel.replace(/\d+:\s/, "");
        for (const armorLevel of armorLevels) {
            let bestType = "";
            let maxDamage = -Infinity;
            for (const attackType of attackTypes) {
                const damage = chartData[attackType][armorLevel][rangeLabel];
                if (damage > maxDamage) {
                    maxDamage = damage;
                    bestType = attackType.replace("Assault Rifle ", "").replace(" Shot", "");
                }
            }
            const bestCell = row.insertCell();
            bestCell.textContent = bestType;
        }
    }
}


function getColorForValue(value) {
    // Define a color range (you can customize this)
    const min = 0;
    const max = 180;
    // Ensure the value is within the range
    const clampedValue = Math.min(Math.max(value, min), max);
    // Calculate the normalized value (0 to 1)
    const normalizedValue = (clampedValue - min) / (max - min);
    // Convert normalized value to an HSL color with a consistent hue, adjusting lightness and saturation
    const hue = 240; // Blue hue
    const saturation = 100;
    const lightness = Math.round((1 - normalizedValue) * 70 + 30); // Lightness from 30 to 100, or a variation of the inverse of the value
    return `hsl(${hue}, ${saturation}%, ${lightness}%)`;
}

const chartKeys = Object.keys(data);

generateHeatMapTable('table1', "Assault Rifle Single Shot", data);
generateHeatMapTable('table2', "Assault Rifle Autofire", data);
generateHeatMapTable('table3', "Assault Rifle Targeted Head Shot", data);
generateHeatMapTable('table4', "Assault Rifle Targeted Leg Shot", data);
generateBestTypeTable('table5', data);